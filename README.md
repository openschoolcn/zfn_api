ğŸ« æ–°æ­£æ–¹æ•™åŠ¡ç®¡ç†ç³»ç»Ÿ API

ğŸ˜ å‡ ä¹è§„é¿æ‰€æœ‰å­¦æ ¡ä¸åŒå¯¼è‡´çš„å…¼å®¹æ€§é—®é¢˜ï¼Œå¯æ”¾å¿ƒé£Ÿç”¨ï¼ï¼

<!-- > âš ï¸ åŸ Django-WebAPI é¡¹ç›®ï¼š[jokerwho/zfnew_wenApi](https://github.com/jokerwho/zfnew_webApi) å·²åœæ­¢æ›´æ–°ï¼Œåç»­ API æ›´æ–°å°†åœ¨æœ¬é¡¹ç›®è¿›è¡Œ -->

æ±‚ â­â­â­â­â­ï¼ˆè·ª

---

## åŠŸèƒ½å®ç°

- [x] ç™»å½•ï¼ˆè‡ªåŠ¨è¯†åˆ«æ˜¯å¦éœ€è¦éªŒè¯ç ï¼‰
- [x] ä¸ªäººä¿¡æ¯
- [x] æˆç»©æŸ¥è¯¢ï¼ˆä¸¤ç§æ¥å£ï¼‰
- [x] è¯¾è¡¨æŸ¥è¯¢
- [x] è¯¾ç¨‹è¡¨ PDF
- [x] å­¦ä¸šç”Ÿæ¶¯æ•°æ®
- [x] å­¦ä¸šç”Ÿæ¶¯ï¼ˆå­¦ä¸šæˆç»©æ€»è¡¨ï¼‰ PDF ï¼ˆ**å­˜åœ¨å…¼å®¹é—®é¢˜**ï¼‰
- [x] åœè¡¥æ¢è¯¾æ¶ˆæ¯
- [x] æŸ¥è¯¢å·²é€‰è¯¾ç¨‹
- [x] è·å–é€‰è¯¾æ¿å—è¯¾åˆ—è¡¨
- [x] é€‰è¯¾
- [x] é€€è¯¾
- [ ] ç©ºæ•™å®¤æŸ¥è¯¢

## çŠ¶æ€ç 

ä¸ºäº†ä¸€äº›ç‰¹æ®Šçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚éªŒè¯ç é”™è¯¯åè‡ªåŠ¨åˆ·æ–°é¡µé¢è·å–ç­‰ï¼Œä½¿ç”¨äº†è‡ªå®šä¹‰çŠ¶æ€ç ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š

| çŠ¶æ€ç  | å†…å®¹                 |
| ------ | -------------------- |
| 998    | ç½‘é¡µå¼¹çª—æœªå¤„ç†å†…å®¹   |
| 999    | æ¥å£é€»è¾‘æˆ–æœªçŸ¥é”™è¯¯   |
| 1000   | è¯·æ±‚è·å–æˆåŠŸ         |
| 1001   | ï¼ˆç™»å½•ï¼‰éœ€è¦éªŒè¯ç    |
| 1002   | ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®   |
| 1003   | è¯·æ±‚è¶…æ—¶             |
| 1004   | éªŒè¯ç é”™è¯¯           |
| 1005   | å†…å®¹ä¸ºç©º             |
| 1006   | cookies å¤±æ•ˆæˆ–è¿‡æœŸ   |
| 1007   | æ¥å£å¤±æ•ˆè¯·æ›´æ–°       |
| 2333   | ç³»ç»Ÿç»´æŠ¤æˆ–æœåŠ¡è¢« ban |

## Tipsâš ï¸

- è¯·å…ˆåœ¨ `config.json` ä¸­ä¿®æ”¹æ•™åŠ¡ç³»ç»Ÿ `base_url` å’Œä¸Šä¸‹è¯¾æ—¶é—´ `raspisanie` ã€‚
  - åªéœ€å¡«å†™`https://xxx.com`åˆ° base_url ä¸­ï¼Œæ‹¼æ¥åä¸ç±»ä¸­ `self.xxurl` ä¸åŒçš„è·¯å¾„éƒ¨åˆ†åœ¨ API ä»£ç å†…å¢åˆ æ”¹ã€‚
- å­¦ä¸šç”Ÿæ¶¯æ•°æ®ä¸ºæ•™åŠ¡ç³»ç»Ÿ **â€œå­¦ç”Ÿå­¦ä¸šæƒ…å†µæŸ¥è¯¢â€** é¡µé¢å†…å®¹ï¼Œè·å–æ•°æ®æ—¶è¯·ç•™æ„ `config.json` ä¸­ `ignore_type` å’Œ `detail_category_type`ã€‚
  - `ignore_type` è¡¨ç¤ºéœ€è¦å¿½ç•¥çš„æœ€é¡¶éƒ¨æ ¹ç±»å‹ï¼Œå¦‚ â€œä¸»ä¿®â€ï¼Œâ€œ20XX çº§ XX ä¸“ä¸šâ€ ç­‰æ— ç”¨ç±»å‹ï¼Œ**å¯ç•™ç©ºæ•°ç»„ï¼Œå¯¹ç»“æœæ— å½±å“**ã€‚
  - `detail_category_type` è¡¨ç¤ºéœ€è¦è¯¦ç»†è·å–è¯¾ç¨‹åˆ†ç±»çš„ç±»å‹ï¼Œå¦‚ â€œå…¶ä»–è¯¾ç¨‹â€ éœ€è·å–è¯¥ç½‘è¯¾å±äºä»€ä¹ˆç±»ç­‰ï¼Œ**å¯ç•™ç©ºæ•°ç»„**ã€‚
- æ•™åŠ¡ç³»ç»Ÿçš„ cookies åœ¨ä¸åŒå­¦æ ¡ç»Ÿä¸€è®¤è¯ç³»ç»Ÿä¸åŒï¼Œ**è‹¥ç³»ç»Ÿå¼€å¯äº†éªŒè¯ç ä¸” cookies æ ¼å¼å†…å®¹ä¸é»˜è®¤æœ‰å‡ºå…¥**ï¼Œè¯·ä¿®æ”¹ `zfn_api.py` ä¸­ `login_with_kaptcha()` ä¸­å…¼å®¹å·®å¼‚æ³¨é‡Šéƒ¨åˆ†ã€‚
- å…¼å®¹å¯¼è‡´ å­¦ä¸šç”Ÿæ¶¯æ•°æ® PDF è¡¨çš„å¯¼å‡ºä¼šå‡ºç°é—®é¢˜ï¼Œå¾…æ’æŸ¥ã€‚
- ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç¤ºä¾‹

  ```python
    # example.py
    import base64
    import os
    import sys
    from pprint import pprint

    from zfn_api import Client

    cookies = {}

    stu = Client(cookies=cookies)

    if cookies == {}:
        lgn = stu.login("sid", "password")
        if lgn["code"] == 1001:
            verify_data = lgn["data"]
            with open(os.path.abspath("kaptcha.png"), "wb") as pic:
                pic.write(base64.b64decode(verify_data.pop("kaptcha_pic")))
            verify_data["kaptcha"] = input("è¾“å…¥éªŒè¯ç ï¼š")
            ret = stu.login_with_kaptcha(**verify_data)
            if ret["code"] != 1000:
                pprint(ret)
                sys.exit()
            pprint(ret)
        elif lgn["code"] != 1000:
            pprint(lgn)
            sys.exit()

    result = stu.get_info()  # è·å–ä¸ªäººä¿¡æ¯
    # result = stu.get_grade(2021, 2)  # è·å–æˆç»©ä¿¡æ¯ï¼Œè‹¥æ¥å£é”™è¯¯è¯·æ·»åŠ  use_personal_info=Trueï¼Œåªå¡«å¹´ä»½è·å–å…¨å¹´
    # result = stu.get_schedule(2022, 1)  # è·å–è¯¾ç¨‹è¡¨ä¿¡æ¯
    # result = stu.get_academia()  # è·å–å­¦ä¸šç”Ÿæ¶¯æ•°æ®
    # result = stu.get_notifications()  # è·å–é€šçŸ¥æ¶ˆæ¯
    # result = stu.get_selected_courses(2022, 1)  # è·å–å·²é€‰è¯¾ç¨‹ä¿¡æ¯
    # result = stu.get_block_courses(2021, 1, 1)  # è·å–é€‰è¯¾æ¿å—è¯¾åˆ—è¡¨
    pprint(result, sort_dicts=False)

    # file_result = stu.get_academia_pdf()["data"]  # è·å–å­¦ä¸šç”Ÿæ¶¯ï¼ˆå­¦ç”Ÿæˆç»©æ€»è¡¨ï¼‰PDFæ–‡ä»¶
    file_result = stu.get_schedule_pdf(2022, 1)["data"]  # è·å–è¯¾ç¨‹è¡¨PDFæ–‡ä»¶
    with open(os.path.abspath("preview.pdf"), "wb") as f:
        f.write(file_result)

  ```

## éƒ¨åˆ†æ•°æ®å­—æ®µè¯´æ˜

```json
{
  // æˆç»©
  "course_id": "è¯¾ç¨‹å·",
  "title": "è¯¾ç¨‹æ ‡é¢˜",
  "teacher": "ä»»è¯¾æ•™å¸ˆ",
  "class_name": "æ•™å­¦ç­åç§°",
  "credit": "å­¦åˆ†",
  "category": "è¯¾ç¨‹ç±»åˆ«",
  "nature": "è¯¾ç¨‹æ€§è´¨",
  "grade": "æˆç»©",
  "grade_point": "ç»©ç‚¹",
  "grade_nature": "æˆç»©æ€§è´¨",
  "start_college": "å¼€è¯¾é™¢ç³»",
  "mark": "",
  // è¯¾è¡¨
  "weekday": "æ˜ŸæœŸå‡ ",
  "time": "ä¸Šè¯¾æ—¶é—´",
  "sessions": "ä¸Šè¯¾èŠ‚æ•°",
  "list_sessions": "å¼€è¯¾èŠ‚æ•°åˆ—è¡¨",
  "weeks": "å¼€è¯¾å‘¨æ•°",
  "list_weeks": "å¼€è¯¾å‘¨æ•°åˆ—è¡¨",
  "evaluation_mode": "è€ƒæ ¸æ–¹å¼",
  "campus": "ä¸Šè¯¾æ ¡åŒº",
  "place": "ä¸Šè¯¾åœºåœ°",
  "hours_composition": "è¯¾ç¨‹å­¦æ—¶ç»„æˆ",
  "weekly_hours": "æ¯å‘¨å­¦æ—¶",
  "total_hours": "æ€»å­¦æ—¶",
  // å­¦ä¸šç”Ÿæ¶¯
  "situation": "ä¿®è¯»æƒ…å†µ",
  "display_term": "ä¿®è¯»å­¦æœŸ",
  "max_grade": "æœ€ä½³æˆç»©",
  // é€‰è¯¾
  "class_id": "æ•™å­¦ç­ID",
  "do_id": "æ‰§è¡ŒID",
  "teacher_id": "æ•™å¸ˆID",
  "kklxdm": "æ¿å—è¯¾ID",
  "capacity": "æ•™å­¦ç­å®¹é‡",
  "selected_number": "å·²é€‰äººæ•°",
  "optional": "æ˜¯å¦è‡ªé€‰",
  "waiting": ""
}
```
